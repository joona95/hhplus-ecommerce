## 요구사항 분석

### 잔액 충전

- 결제에 사용될 금액을 충전한다.

- 사용자 식별자 및 충전할 금액을 받아 잔액을 충전한다.

- 음수는 충전할 수 없다.

- 최대 잔액 제한을 넘어서 충전할 수 없다.

### 잔액 조회

- 사용자 식별자를 통해 사용자의 잔액을 조회한다.

### 상품 조회

- 상품 식별자를 통해 상품 정보를 조회한다.

  - ID
  - 이름
  - 가격
  - 잔여수량

- 조회 시점의 상품별 잔여수량이 정확하면 좋다.

### 선착순 쿠폰 발급

- 사용자 식별자와 쿠폰 식별자로 쿠폰을 발급받을 수 있다.

- 사용자는 선착순으로 할인 쿠폰을 발급받을 수 있다.

  - 이미 선착순으로 모두 발급된 경우 쿠폰을 발급받을 수 없다.

### 보유 쿠폰 목록 조회

- 사용자 식별자로 보유 쿠폰 목록을 조회할 수 있다.

### 주문 / 결제

- 사용자 식별자와 (상품 ID, 수량) 목록을 입력받아 주문하고 결제한다.

  - 한 주문에 여러 상품을 구매할 수 있다.

- 주문 성공 시 주문 내역과 결제 내역을 저장한다.

- 결제는 기 충전된 잔액을 기반으로 수행하며 성공할 시 잔액을 차감한다.

- 주문 시 유효한 할인 쿠폰을 제출하면, 전체 주문 금액에 대한 할인 혜택을 부여받는다.

  - 발급된 쿠폰을 사용 상태로 변경한다.

- 결제 성공 시에 실시간으로 주문 정보를 데이터 플랫폼에 전송해야 한다.

### 상위 상품 조회

- 최근 3일간 (3일 전 ~ 1일 전) 가장 많이 팔린 상위 5개 상품 정보를 제공한다.

